<mat-drawer-container autosize
  *ngIf="components$ | async as components">
  <mat-drawer #drawer
    mode="side"
    [opened]="true">
    <div class="header"
      [ngClass]="{ 'mat-elevation-z8': showHeaderShadow$ | async }">
      <h2>Components</h2>
      <small>Drag and drop components from below into your template</small>
    </div>
    <div cdkDropList
      #componentsList="cdkDropList"
      [cdkDropListData]="components"
      [cdkDropListConnectedTo]="[templateList]"
      class="component-list"
      (cdkDropListDropped)="drop($event)"
      (scroll)="componentsScrollHandler($event)">
      <button mat-raised-button
        *ngIf="isAdmin"
        color="primary"
        class="add-component-button"
        (click)="openAddComponentDialog()">
        Add Component
      </button>
      <div class="component mat-elevation-z1"
        *ngFor="let item of components"
        cdkDrag>
        <button *ngIf="isAdmin"
          mat-mini-fab
          (click)="deleteComponent(item)"
          color="warn">
          <mat-icon>delete</mat-icon>
        </button>
        <img [src]="apiBase + '/components/' + item">
      </div>
    </div>
  </mat-drawer>

  <div class="sidenav-content">
    <div class="title mat-elevation-z1">
      <h2>Template</h2>
    </div>
    <div class="template-container"
      [style.width]="(800 * zoom) + 'px'">
      <div cdkDropList
        #templateList="cdkDropList"
        [cdkDropListData]="template"
        [cdkDropListConnectedTo]="[componentsList]"
        class="template"
        (cdkDropListDropped)="drop($event)">
        <div class="component"
          *ngFor="let item of template"
          cdkDrag>
          <img [src]="apiBase + '/components/' + item">
        </div>
      </div>
    </div>

    <div class="template-controls mat-elevation-z2">
      <span [style.fontWeight]="'bold'">Zoom</span>
      <button mat-icon-button
        (click)="zoom = zoom + 0.1">
        <mat-icon>add</mat-icon>
      </button>
      <span class="current-zoom">{{ zoom | percent }}</span>
      <button mat-icon-button
        (click)="zoom = zoom - 0.1">
        <mat-icon>remove</mat-icon>
      </button>
      <ng-container *ngIf="template.length">
        <hr>
        <button mat-icon-button
          (click)="clearTemplate()"
          color="warn">
          <mat-icon>delete</mat-icon>
        </button>
      </ng-container>
    </div>
  </div>

</mat-drawer-container>